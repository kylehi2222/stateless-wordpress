function generateCacheVar(e){for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",i=0;i<e;i++){t+=a[Math.floor(Math.random()*a.length)]}return t}var alertMessage=function(e,a,t){var i=jQuery('<div class="notice notice-'+a+' is-dismissible"><p>'+e+"</p></div>").insertBefore(".attachment-info .settings-save-status");setTimeout(function(){i.fadeOut(function(){i.remove()})},1e3*t)},replaceMedia=function(a){var t;t||(t=wp.media.frames.file_frame=wp.media({title:AzureMediaReplaceObject.i18n.title,frame:"select",button:{text:AzureMediaReplaceObject.i18n.replaceMediaButton},multiple:!1}).on("select",function(){var e=t.state().get("selection").first().toJSON();jQuery.ajax({type:"post",url:AzureMediaReplaceObject.ajaxUrl,data:{action:"azure-storage-media-replace",current_attachment:a,nonce:AzureMediaReplaceObject.nonce,replace_attachment:e.id},dataType:"JSON",beforeSend:function(){jQuery(".settings-save-status").find(".spinner").addClass("is-active"),jQuery(".edit-media-header").find(".media-modal-close").first().prop("disabled",!0)},success:function(e){if("success"in e&&!e.success)return jQuery(".settings-save-status").find(".spinner").removeClass("is-active"),jQuery(".edit-media-header").find(".media-modal-close").first().prop("disabled",!1),void alertMessage(e.data,"error",5);jQuery(".settings-save-status").find(".spinner").removeClass("is-active"),jQuery(".edit-media-header").find(".media-modal-close").first().prop("disabled",!1);var a=jQuery(".media-modal").find(".details-image").attr("src"),t=generateCacheVar(7);jQuery(".media-modal").find(".details-image").attr("src",a+"?v="+t);var i=a;e.meta_data.sizes.medium.length?i=e.meta_data.sizes.medium:e.meta_data.sizes.thumbnail.length&&(i=e.meta_data.sizes.thumbnail),jQuery(".attachments-wrapper").find('li[data-id="'+e.id+'"]').find("img").first().attr("src",i+"?v="+t),jQuery(".attachments-wrapper").find('li[data-id="'+e.old_ID+'"]').remove()},error:function(e,a,t){jQuery(".settings-save-status").find(".spinner").removeClass("is-active"),jQuery(".edit-media-header").find(".media-modal-close").first().prop("disabled",!1);var i="Error: "+t+"\nStatus: "+a;i(i,"error",5),console.error("AJAX request failed: ",a,t)}})})).on("open",function(){t.reset();var e=jQuery(t.el),a=e.find("#menu-item-upload");e.find("#menu-item-browse").css("display","none"),a.trigger("click")}),t.open()};