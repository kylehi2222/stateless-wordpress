{"version":3,"file":"affiliatewp-mtc-admin.min.js","sources":["affiliatewp-mtc-admin.min.js"],"sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n/**\n * AffiliateWP Multi-Tier Commissions admin\n *\n * @since 1.0.0\n */\n\n'use strict';\n\n/* eslint-disable no-console, no-undef */\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\naffiliatewp.attach('mtc',\n/**\n * MTC Component.\n *\n * @since 1.0.0\n */\n{\n  /**\n   * Populated dynamically via wp_add_inline_script().\n   */\n  data: {},\n  /**\n   * Adds select2 functionality to the Parent Affiliate field.\n   *\n   * @since 1.0.0\n   */\n  initParentAffiliateDropdown: function initParentAffiliateDropdown() {\n    var perPage = 10;\n    jQuery('#parent-affiliate-id').off().select2({\n      width: '350px',\n      allowClear: false,\n      ajax: {\n        url: affiliatewp.mtc.data.ajaxUrl,\n        dataType: 'json',\n        delay: 250,\n        data: function data(params) {\n          var _affiliatewp$mtc$data;\n          return {\n            action: 'affiliatewp_mtc_parent_affiliate_select',\n            nonce: affiliatewp.mtc.data.nonce,\n            q: params.term,\n            page: params.page || 1,\n            per_page: perPage,\n            affiliate_id: (_affiliatewp$mtc$data = affiliatewp.mtc.data.affiliateID) !== null && _affiliatewp$mtc$data !== void 0 ? _affiliatewp$mtc$data : 0\n          };\n        },\n        processResults: function processResults(data, params) {\n          params.page = params.page || 1;\n          return {\n            results: data.items,\n            pagination: {\n              more: params.page * perPage < data.total\n            }\n          };\n        },\n        cache: true\n      },\n      placeholder: affiliatewp.mtc.data.i18n.select2placeholder,\n      minimumInputLength: -1\n    });\n\n    // Open the select2 dropdown when clicking on the Parent Affiliate label.\n    jQuery('.form-row[data-field=\"parent-affiliate\"] label').on('click', function () {\n      jQuery(this).closest('tr').find('select').select2('open');\n    });\n  },\n  /**\n   * Toggle the remove button visibility.\n   *\n   * The remove button should be visible only if we have 3 or more tiers on the screen,\n   * since this is a multi tier system, we always need more than one tier configured.\n   *\n   * @since 1.0.0\n   */\n  toggleRemoveButtonVisibility: function toggleRemoveButtonVisibility() {\n    var $removeTier = jQuery('.affwp-remove-tier');\n\n    // Determine if the remove tier button should be shown or hidden.\n    if (jQuery('.affwp-tier-row').length >= 3) {\n      $removeTier.css('display', 'block');\n      return;\n    }\n    $removeTier.css('display', 'none');\n  },\n  initSelect2: function initSelect2($elements) {\n    $elements.each(function () {\n      var $select = jQuery(this);\n      $select.select2(affiliatewp.parseArgs(\n      /*\n       * You can use an object with select2 arguments in your select tag to override\n       * the select2 defaults or add new setting.\n       */\n      $select.data('select2-settings') || {}, {\n        width: '170px',\n        minimumResultsForSearch: -1\n      }));\n    });\n  },\n  /**\n   * Initiate the tiers repeater in the Settings screen.\n   *\n   * @since 1.0.0\n   */\n  initTiersRepeater: function initTiersRepeater() {\n    // The table body jQuery object.\n    var $root = jQuery('#affwp-tier-rows');\n\n    // Add new button jQuery object.\n    var $addNewButton = jQuery('#affwp-new-tier');\n\n    // Tracks the total number of rows added so far.\n    var total = $root.find('.affwp-tier-row').length;\n    var getRowTemplate = function getRowTemplate(fields) {\n      // Copy the row HTML template.\n      var row = affiliatewp.mtc.data.tiersRowHtml;\n\n      // Replace all the {{var}} found in the HTML template.\n      Object.entries(fields).forEach(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n          key = _ref2[0],\n          value = _ref2[1];\n        row = row.replace(new RegExp(\"{{\\\\b\".concat(key, \"\\\\b}}\"), 'g'), value);\n      });\n      return row;\n    };\n    $addNewButton.on('click', function (e) {\n      e.preventDefault();\n      var $row = jQuery(getRowTemplate({\n        index: total,\n        rate: '',\n        flat_type_options: ''\n      }));\n      $root.append($row);\n\n      // Update total of rows.\n      total = $root.find('.affwp-tier-row').length;\n      affiliatewp.mtc.toggleRemoveButtonVisibility();\n      affiliatewp.mtc.initSelect2($row.find('select'));\n\n      // Focus on the input field in the new row.\n      $root.find('.affwp-tier-row').find('input').focus();\n\n      // Cap the number of tiers.\n      if (total >= affiliatewp.mtc.data.maxReferralTiers) {\n        $addNewButton.attr('disabled', true);\n        $addNewButton.attr('aria-disabled', true);\n      }\n    });\n\n    // Remove row.\n    jQuery(document).on('click', '.affwp-remove-tier', function (e) {\n      e.preventDefault();\n\n      // Ensure the button is always active.\n      $addNewButton.attr('disabled', false);\n      $addNewButton.attr('aria-disabled', false);\n\n      // Remove the row.\n      jQuery(this).parent().remove();\n      affiliatewp.mtc.toggleRemoveButtonVisibility();\n    });\n    affiliatewp.mtc.toggleRemoveButtonVisibility();\n  }\n});\n\n},{}]},{},[1]);\n"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","_slicedToArray","arr","Array","isArray","l","Symbol","iterator","next","Object","done","push","value","minLen","_arrayLikeToArray","prototype","toString","slice","constructor","name","from","test","TypeError","len","arr2","affiliatewp","attach","data","initParentAffiliateDropdown","jQuery","off","select2","width","allowClear","ajax","url","mtc","ajaxUrl","dataType","delay","params","action","nonce","q","term","page","per_page","affiliate_id","_affiliatewp$mtc$data","affiliateID","processResults","results","items","pagination","more","total","cache","placeholder","i18n","select2placeholder","minimumInputLength","on","this","closest","find","toggleRemoveButtonVisibility","$removeTier","css","initSelect2","$elements","each","$select","parseArgs","minimumResultsForSearch","initTiersRepeater","$root","$addNewButton","preventDefault","row","$row","fields","index","rate","flat_type_options","tiersRowHtml","entries","forEach","_ref","_ref2","key","replace","RegExp","concat","append","focus","maxReferralTiers","attr","document","parent","remove"],"mappings":"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"}