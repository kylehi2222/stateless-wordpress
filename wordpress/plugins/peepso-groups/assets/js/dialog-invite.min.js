!function n(r,h,p){function l(t,e){if(!h[t]){if(!r[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(u)return u(t,!0);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}var s=h[t]={exports:{}};r[t][0].call(s.exports,function(e){return l(r[t][1][e]||e)},s,s.exports,n,r,h,p)}return h[t].exports}for(var u="function"==typeof require&&require,e=0;e<p.length;e++)l(p[e]);return l}({1:[function(e,t,i){(function(e){"use strict";var t,i,n,o,s="undefined"!=typeof window?window.peepso:void 0!==e?e.peepso:null,r=window.peepsogroupsdata&&window.peepsogroupsdata.dialogInviteTemplate;t=jQuery,i="PsGroupDialogInvite",n=t,o=peepso.createClass(i,{__constructor:function(e){this.popup=(0,s.dialog)(r,{wide:!0,onClose:this.onClose.bind(this)}).show(),this.$el=this.popup.$el,this.$scrollable=this.$el.find(".ps-js-scrollable"),this.$list=this.$el.find(".ps-js-member-items"),this.$loading=this.$el.find(".ps-js-loading").hide(),this.$more=this.$el.find(".ps-js-loadmore").hide(),this.$nomore=this.$el.find(".ps-js-nomore").hide(),this.itemTemplate=this.$el.find(".ps-js-member-item").html(),this.itemTemplate=peepso.template(this.itemTemplate),this.$el.on("input","input[type=text]",n.proxy(this.onInput,this)),this.$el.on("click",".ps-js-invite",n.proxy(this.onInvite,this)),this.$el.appendTo(document.body),this.$scrollable.bind("mousewheel",n.proxy(function(e,t){var i=n(e.currentTarget);(0<t&&0===i.scrollTop()||t<0&&i.scrollTop()==i.get(0).scrollHeight-i.innerHeight())&&e.preventDefault()},this)),this.groupId=e,this.search()},search:function(e,t){this.$loading.show(),this.$more.hide(),this.$nomore.hide(),(!t||t<=1)&&this.$list.empty(),this._search(e,t)},_search:_.debounce(function(e,t){var i={group_id:this.groupId,query:e||void 0,keys:"id,avatar,fullname,profileurl,fullname_with_addons",limit:6,page:t||1};this.fetch(i).done(n.proxy(function(e){this.render(e);var t=this.$scrollable[0];setTimeout(function(){t.scrollTop=t.scrollHeight},100)},this)).fail(n.proxy(function(e){1<i.page?this.$nomore.show():this.renderError(e)},this))},500),fetch:function(i){return n.Deferred(n.proxy(function(t){peepso.getJson("groupusersajax.search_to_invite",i,n.proxy(function(e){this.$loading.hide(),e.success?(t.resolveWith(this,[e.data]),6<=e.data.users.length?this.$more.show().off("click").one("click",n.proxy(function(){this.search(i.query,i.page+1)},this)):(this.$more.hide().off("click"),1<i.page&&this.$nomore.show())):t.rejectWith(this,[e.errors])},this))},this))},render:function(e){var t="";if(e.users&&e.users.length){for(var i=0;i<e.users.length;i++)t+=this.itemTemplate(n.extend({group_id:this.groupId},e.users[i]));this.$list.append(t)}},renderError:function(e){e&&e.length&&this.$list.html(e.join("<br />"))},invite:function(e){return n.Deferred(n.proxy(function(t){ps_group.inviteUser(this.groupId,e).done(n.proxy(function(e){t.resolveWith(this,[e])},this)).fail(n.proxy(function(e){t.rejectWith(this,[e])},this))},this))},onInput:function(e){e.preventDefault(),e.stopPropagation(),this.search(n.trim(e.target.value))},onInvite:function(e){var t=n(e.currentTarget),i=t.find("img").show(),o=t.find("span"),s=t.data("id");e.preventDefault(),e.stopPropagation(),this.invite(s).always(function(){i.hide()}).done(function(){o.html(o.data("invited")),t.attr("disabled","disabled")})},onClose:function(){this.popup.opts.reloadOnClose&&setTimeout(function(){window.location.reload()},500)}}),peepso.groups||(peepso.groups={}),peepso.groups.dlgInvite=function(e){new o(e).popup.show()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]);